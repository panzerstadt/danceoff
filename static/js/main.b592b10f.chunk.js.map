{"version":3,"sources":["pages/Intro/index.module.css","App.module.css","components/Navigation/index.module.css","components/Button/index.module.css","assets/images/danceoff.png","pages/Leaderboard/index.module.css","pages/Learn/index.module.css","logo.svg","assets/videos/RAHMAT_SIMPLE_2.mp4","components/Navigation/Buttons.module.css","components/Posenet/index.module.css","lib/constants.js","components/Navigation/Buttons.js","components/Navigation/index.js","components/Button/index.js","pages/Intro/index.js","assets/svg/loop.svg","pages/Learn/index.js","components/Posenet/helpers/utils.js","components/Posenet/helpers/cosineSimilarity.js","components/Posenet/helpers/scorer.js","components/Posenet/helpers/calculatePeakBeats.js","components/Posenet/Posenet.js","components/Posenet/index.js","pages/Record/index.js","lib/firebase.js","components/Rankings/index.js","components/PostRanking/index.js","pages/Leaderboard/index.js","App.js","serviceWorker.js","index.js","components/PostRanking/index.module.css","components/Rankings/index.module.css","pages/Record/index.module.css"],"names":["module","exports","page","hero","startBtn","app","nav","bigBtn","default","intro","__webpack_require__","p","video","videoControls","buttons","seekBar","seekBtn","btn","dummy","playPause","loop","loopIcon","activeLoop","modeButtons","toggleButton","toggleButtonRight","btnContainer","toggles","btnLeft","btnRight","hasRecording","hasRecordingMain","hasRecordingSecondary","loading","posenet","download","button","contextualOptions","contextualOptionsDiv","replayDiv","scrubberDiv","scrubberInnerDiv","scores","s","score","totalScore","videoPlayer","posenetCanvasContainer","posenetCanvas","DANCE_GHOST","require","DANCE_VIDEO","ModeButtons","_ref","_ref$recordings","recordings","_ref$onToggle","onToggle","v","console","log","length","react_default","a","createElement","className","styles","onClick","style","padding","Page","props","useEffect","Buttons_ModeButtons","Buttons","Button","children","_ref$theme","theme","rest","Object","objectWithoutProperties","assign","src","dance","alt","components_Button","_extends","target","i","arguments","source","key","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","loop_ref2","d","loop_SvgLoop","svgRef","id","x","y","viewBox","enableBackground","xmlSpace","width","height","ref","ForwardRef","forwardRef","_useState","useState","_useState2","slicedToArray","setLoop","_useState3","_useState4","play","setPlay","_useState5","_useState6","progress","setProgress","_useState7","_useState8","seekVal","setSeekVal","fraction","played","_useState9","_useState10","loaded","setLoaded","_useState11","_useState12","seek","setSeek","playerRef","useRef","current","seekTo","ReactPlayer_default","url","playing","onProgress","onReady","dist","onChange","e","direction","Direction","HORIZONTAL","value","_ref2","position","borderRadius","top","left","concat","marginTop","marginLeft","bottom","marginBottom","Pause","Play","isMobile","test","navigator","userAgent","drawKeypoints","keypoints","minConfidence","skeletonColor","ctx","scale","undefined","translate","forEach","keypoint","_keypoint$position","t_x","t_y","beginPath","arc","Math","PI","fillStyle","fill","toTranslatedTuple","drawSkeleton","color","lineWidth","_ref3","_ref4","_ref5","ay","ax","_ref6","by","bx","moveTo","lineTo","strokeStyle","stroke","drawSegment","magnitude","vec","squaredTotal","map","num","pow","reduce","b","sqrt","cosineSimilarity","vector1","vector2","vec1","vec2","Error","dotProduct","remap","low1","high1","low2","high2","vectorizePose","pose","arrayOut","resize","cleanup","_calculatePoseDomain","extent","calculatePoseDomain","xMin","xMax","yMin","yMax","len","slice","scoreSimilarity","currentPose","currentTimeFrame","comparisonPoseSet","compareNearestFrames","includeDistance","accuracyInDecimals","c_Pose","scoreFrames","frameNumber","poseSet","count","includeDist","index","split","round","leftHalf","Array","max","rightHalf","closestNIndices","toConsumableArray","sort","distance","abs","findClosestPoses","weightedSimilarity","vs_pose","comparisonPose","comparisonPoseConfidence","comparisonPoseDistance","comparisonPoseIndex","similarity","toFixed","highestScore","reverse","currentFrameScore","filter","normalized","highest","all","generateScoreTimer","def","totalSecs","beatsPerLoop","loopSec","pattern","beatUnit","total","peaks","scoreTimeStamp","beat","secs","push","shift","defaultProps","GHOST","poseRecords","SCORING_HEURISTIC","timestamp","PoseNetComponent","state","error_messages","stream","trace","frames","ghostIndex","repeat","scoreOpacity","time","stop","finalDims","camera","timeout","good_keypoints","previousDelta","lastScore","errorMessages","_this","getVideoRecords","tracePose","poses","record","setState","traceVideo","blob","getCanvas","elem","canvas","getVideo","stopCamera","cam","srcObject","getTracks","t","startCamera","setupCamera","_callee","e1","_this$props","videoWidth","videoHeight","regenerator_default","wrap","_context","prev","next","mediaDevices","getUserMedia","frontCamera","objectFit","abrupt","Promise","resolve","onloadedmetadata","detectPose","getContext","poseDetectionFrame","_this$props2","algorithm","imageScaleFactor","forceFlipHorizontal","outputStride","minPoseConfidence","maxPoseDetections","minPartConfidence","nmsRadius","showVideo","showPoints","showSkeleton","ghostColor","skeletonLineWidth","translateGhost","maxFPS","compete","scoreByHeuristic","net","heuristic","flipped","poseDetectionFrameInner","asyncToGenerator","mark","_callee2","currentDelta","delta","maxDelta","millis","ind","g_keypoints","g_score","g_timestamp","timestamp_now","userPose","GHOST_timestamp","NOW_timestamp","singlePose","REC","NOW","_context2","requestAnimationFrame","parseInt","t0","estimateSinglePose","sent","estimateMultiplePoses","clearRect","save","drawImage","restore","performance","now","floor","onEnd","recordVideo","toBlob","getPoseRecords","prevState","objectSpread","_x","mobileNetArchitecture","e2","prevProps","clearTimeout","setTimeout","_this2","_this3","loadingText","fontSize","opacity","overflow","react_webcam_default","playsInline","Component","window","innerWidth","innerHeight","Posenet","onScore","onRestart","restarting","setRestarting","setScore","phase","setPhase","dims","setDims","min","onTracePose","onTraceVideo","handleRecordEnd","type","modalStart","modalEnd","restart","config","apiKey","process","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","reactConfig","firebase","apps","initializeApp","Rankings","rankings","setRankings","databaseRef","sortKey","limit","callback","database","orderByChild","limitToLast","on","snapshot","sortedVals","child","val","ReadSortedFromFirebase","Fragment","title","rankingOL","k","rankingLI","user","Submit","username","setUsername","userScore","setUserScore","posted","setPosted","form","formDiv","onSubmit","data","then","PushToFirebase","preventDefault","cta","input","placeholder","thanks","thankYou","components_Rankings","PostRanking","App","setPage","handleScore","handleRestart","Intro","Learn","Record","Leaderboard","Navigation","Boolean","location","hostname","match","ReactDOM","render","src_App_0","document","getElementById","serviceWorker","ready","registration","unregister","modal"],"mappings":"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","file":"static/js/main.b592b10f.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"page\":\"Intro_page__1L74o Layout_page__3AEwV\",\"hero\":\"Intro_hero__2ooq0\",\"startBtn\":\"Intro_startBtn__3vE0Y\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"app\":\"App_app__3VY0g\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"nav\":\"Navigation_nav__wajNd\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"bigBtn\":\"Button_bigBtn__2JwRJ\",\"default\":\"Button_default__18Fup Button_bigBtn__2JwRJ\",\"intro\":\"Button_intro__1kxON Button_bigBtn__2JwRJ\"};","module.exports = __webpack_public_path__ + \"static/media/danceoff.8f298f1e.png\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"page\":\"Leaderboard_page__22xay Layout_page__3AEwV\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"page\":\"Learn_page__3EZKE Layout_page__3AEwV\",\"video\":\"Learn_video__2sdSS\",\"videoControls\":\"Learn_videoControls__2pAe2\",\"buttons\":\"Learn_buttons__2ncbD\",\"seekBar\":\"Learn_seekBar__BU6xs\",\"seekBtn\":\"Learn_seekBtn__1bftA\",\"btn\":\"Learn_btn__2lKpL\",\"dummy\":\"Learn_dummy__2jhKp Learn_btn__2lKpL\",\"playPause\":\"Learn_playPause__L6Q9A Learn_btn__2lKpL\",\"loop\":\"Learn_loop__R7rsF Learn_btn__2lKpL\",\"loopIcon\":\"Learn_loopIcon__1fX86\",\"activeLoop\":\"Learn_activeLoop__SSIod Learn_loopIcon__1fX86\"};","module.exports = __webpack_public_path__ + \"static/media/logo.5d5d9eef.svg\";","module.exports = __webpack_public_path__ + \"static/media/RAHMAT_SIMPLE_2.58582f69.mp4\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"modeButtons\":\"Buttons_modeButtons__2HNnR\",\"toggleButton\":\"Buttons_toggleButton__3kNmh\",\"toggleButtonRight\":\"Buttons_toggleButtonRight__2C7P- Buttons_toggleButton__3kNmh\",\"btnContainer\":\"Buttons_btnContainer__18RFq\",\"toggles\":\"Buttons_toggles__1TOAn\",\"btn\":\"Buttons_btn__33UXZ\",\"btnLeft\":\"Buttons_btnLeft__1oo4l Buttons_btn__33UXZ\",\"btnRight\":\"Buttons_btnRight__3yaS_ Buttons_btn__33UXZ\",\"hasRecording\":\"Buttons_hasRecording__GrAuA\",\"hasRecordingMain\":\"Buttons_hasRecordingMain__-UFBG Buttons_hasRecording__GrAuA\",\"hasRecordingSecondary\":\"Buttons_hasRecordingSecondary__84sWz Buttons_hasRecording__GrAuA\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"loading\":\"Posenet_loading__zk9xm\",\"posenet\":\"Posenet_posenet__2HVBw\",\"download\":\"Posenet_download__UlZD3\",\"button\":\"Posenet_button__gtwpS\",\"contextualOptions\":\"Posenet_contextualOptions__2idSY\",\"contextualOptionsDiv\":\"Posenet_contextualOptionsDiv__1Y5Xa\",\"replayDiv\":\"Posenet_replayDiv__3a_WU\",\"scrubberDiv\":\"Posenet_scrubberDiv__2iI79\",\"scrubberInnerDiv\":\"Posenet_scrubberInnerDiv__u-HoF\",\"scores\":\"Posenet_scores__1uGS0\",\"s\":\"Posenet_s__1W1MI\",\"score\":\"Posenet_score__jromn Posenet_s__1W1MI\",\"totalScore\":\"Posenet_totalScore__2K4cr Posenet_s__1W1MI\",\"videoPlayer\":\"Posenet_videoPlayer__3YJUB\",\"posenetCanvasContainer\":\"Posenet_posenetCanvasContainer__1zoyz\",\"posenetCanvas\":\"Posenet_posenetCanvas__17frf\"};","export const DEBUG = false;\nexport const COLORS = {\n  main: \"#5FD49B\",\n  secondary: \"#FF8547\",\n  highlight: \"#BAFFFF\"\n};\n\nexport const DB_PATH = \"danceoff/leaderboard\";\n\nexport const DANCE_GHOST = require(\"../assets/posenet/data/RAHMAT_SIMPLE_2.json\");\nexport const DANCE_VIDEO = require(\"../assets/videos/RAHMAT_SIMPLE_2.mp4\");\n","import React, { useEffect } from \"react\";\n\nimport styles from \"./Buttons.module.css\";\n// constants\nimport { COLORS } from \"../../lib/constants\";\n\nconst ModeButtons = ({\n  recordings = [],\n  onToggle = v => console.log(\"toggled! \" + v)\n}) => {\n  const hasRecording = recordings.length === 0;\n  return (\n    <div className={styles.modeButtons}>\n      <div className={styles.btnContainer}>\n        <button\n          className={\n            styles.btnLeft +\n            \" \" +\n            (hasRecording ? styles.hasRecordingSecondary : \"\")\n          }\n          onClick={() => onToggle(\"watch\")}\n          style={{\n            padding: \"8px 15px\"\n          }}\n        >\n          WATCH ▶️\n        </button>\n        <button\n          className={\n            styles.btn + \" \" + (!hasRecording ? styles.hasRecordingMain : \"\")\n          }\n          onClick={() => onToggle(\"record\")}\n          style={{\n            padding: \"8px 15px\"\n          }}\n        >\n          RECORD 📹\n        </button>\n        <button\n          className={\n            styles.btnRight +\n            \" \" +\n            (!hasRecording ? styles.hasRecordingMain : \"\")\n          }\n          onClick={() => onToggle(\"compete\")}\n          style={{\n            padding: \"8px 15px\"\n          }}\n        >\n          COMPETE ⚔️\n        </button>\n      </div>\n    </div>\n  );\n};\n\nconst Page = props => {\n  useEffect(() => {\n    // didmount\n    console.log(\"mounted this navigation page yo\");\n\n    return () => console.log(\"unmounted this navigation page yo\");\n  }, []);\n  return <ModeButtons {...props} />;\n};\n\nexport default Page;\n","import React from \"react\";\n\nimport styles from \"./index.module.css\";\n\nimport Buttons from \"./Buttons\";\n\nconst Page = ({ onClick }) => {\n  return (\n    <div className={styles.nav}>\n      <Buttons onToggle={onClick} />\n    </div>\n  );\n};\n\nexport default Page;\n","import React from \"react\";\n\nimport styles from \"./index.module.css\";\n\nconst Button = ({ children, onClick, theme = \"default\", ...rest }) => {\n  return (\n    <button className={styles[theme]} onClick={onClick} {...rest}>\n      {children || \"button\"}\n    </button>\n  );\n};\n\nexport default Button;\n","import React, { useEffect } from \"react\";\n\nimport styles from \"./index.module.css\";\n\nimport Button from \"../../components/Button\";\n\n// assets\nimport dance from \"../../assets/images/danceoff.png\";\n\nconst Page = ({ onClick }) => {\n  useEffect(() => {\n    // didmount\n    console.log(\"mounted this page yo\");\n\n    return () => console.log(\"unmounted this page yo\");\n  }, []);\n  return (\n    <div className={styles.page}>\n      <img className={styles.hero} src={dance} alt=\"danceoff!\" />\n      <Button theme=\"intro\" onClick={onClick}>\n        START\n      </Button>\n    </div>\n  );\n};\n\nexport default Page;\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"g\", null, React.createElement(\"path\", {\n  d: \"M256.5,286c76.683,0,142.5-64.228,142.5-142.5C399,64.9,335.1,0,256.5,0S113,64.9,113,143.5   c0,35.099,12.9,66.899,34.2,91.5c3.005-1.994,21.385-18.847,53.399-29.7C183.8,190,173,168.1,173,143.5   c0-45.601,37.899-82.5,83.5-82.5S339,97.899,339,143.5c0,44.65-35.839,82.5-82.5,82.5C181.597,226,113,288.457,113,368.5   c0,78.6,64.9,143.5,143.5,143.5S399,447.1,399,368.5c0-35.101-12.9-66.901-34.2-91.5c-3.005,1.994-21.385,18.845-53.399,29.7   C328.2,322,339,343.9,339,368.5c0,45.599-36.899,83.5-82.5,83.5S173,414.099,173,368.5C173,323.85,209.839,286,256.5,286z\"\n}));\n\nvar SvgLoop = function SvgLoop(_ref) {\n  var svgRef = _ref.svgRef,\n      props = _objectWithoutProperties(_ref, [\"svgRef\"]);\n\n  return React.createElement(\"svg\", _extends({\n    id: \"Layer_1\",\n    x: \"0px\",\n    y: \"0px\",\n    viewBox: \"0 0 512 512\",\n    style: {\n      enableBackground: \"new 0 0 512 512\"\n    },\n    xmlSpace: \"preserve\",\n    width: 512,\n    height: 512,\n    ref: svgRef\n  }, props), _ref2);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgLoop, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/loop.21dce757.svg\";\nexport { ForwardRef as ReactComponent };","import React, { useEffect, useState, useRef } from \"react\";\nimport ReactPlayer from \"react-player\";\nimport { Direction, Slider, PlayerIcon } from \"react-player-controls\";\n\nimport styles from \"./index.module.css\";\n\nimport { ReactComponent as LoopIcon } from \"../../assets/svg/loop.svg\";\nimport { DANCE_VIDEO as video } from \"../../lib/constants\";\n\nconst Page = () => {\n  const [loop, setLoop] = useState(true);\n  const [play, setPlay] = useState(true);\n\n  // update slider progress\n  const [progress, setProgress] = useState();\n  const [seekVal, setSeekVal] = useState(0);\n  useEffect(() => {\n    if (progress) {\n      // there's more stuff\n      const fraction = progress.played;\n      setSeekVal(fraction);\n    }\n  }, [progress]);\n\n  // seek slider\n  const [loaded, setLoaded] = useState(false);\n  const [seek, setSeek] = useState(0);\n  const playerRef = useRef();\n  useEffect(() => {\n    if (loaded && playerRef) {\n      playerRef.current.seekTo(seek);\n      setSeekVal(seek);\n    }\n  }, [seek]);\n  const scrubVideo = e => {\n    setSeek(e);\n  };\n\n  // style slider and slider handle\n  const SliderBar = ({ direction, value, style, className }) => (\n    <div className={className} style={style} />\n  );\n  const SliderHandle = ({ direction, value, style, className }) => (\n    <div\n      className={className}\n      style={Object.assign(\n        {},\n        {\n          position: \"absolute\",\n          width: 16,\n          height: 16,\n          borderRadius: \"100%\"\n        },\n        direction === Direction.HORIZONTAL\n          ? {\n              top: 0,\n              left: `${value * 100}%`,\n              marginTop: -5,\n              marginLeft: -8\n            }\n          : {\n              left: 0,\n              bottom: `${value * 100}%`,\n              marginBottom: -8,\n              marginLeft: -4\n            },\n        style\n      )}\n    />\n  );\n\n  return (\n    <div className={styles.page}>\n      <ReactPlayer\n        ref={playerRef}\n        height=\"100%\"\n        url={video}\n        playing={play}\n        loop={loop}\n        onProgress={setProgress}\n        onReady={() => setLoaded(true)}\n      />\n      <div className={styles.videoControls}>\n        {/* <div className={styles.seekBar}>\n          <button className={styles.seekBtn} />{\" \"}\n        </div> */}\n        <Slider onChange={scrubVideo} direction={Direction.HORIZONTAL}>\n          <SliderBar\n            className={styles.seekBar}\n            value={seekVal}\n            direction={Direction.HORIZONTAL}\n          />\n          <SliderHandle\n            className={styles.seekBtn}\n            value={seekVal}\n            direction={Direction.HORIZONTAL}\n          />\n        </Slider>\n\n        <div className={styles.buttons}>\n          <p className={styles.dummy} />\n          <button className={styles.playPause} onClick={() => setPlay(!play)}>\n            {play ? (\n              <PlayerIcon.Pause height={20} />\n            ) : (\n              <PlayerIcon.Play height={20} />\n            )}\n          </button>\n          <button className={styles.loop} onClick={() => setLoop(!loop)}>\n            <LoopIcon className={loop ? styles.activeLoop : styles.loopIcon} />\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Page;\n","import * as posenet from \"@tensorflow-models/posenet\";\n\nexport const isAndroid = () => /Android/i.test(navigator.userAgent);\n\nexport const isiOS = () => /iPhone|iPad|iPod/i.test(navigator.userAgent);\n\nexport const isMobile = () => isAndroid() || isiOS();\n\nexport const drawKeypoints = (\n  keypoints,\n  minConfidence,\n  skeletonColor,\n  ctx,\n  scale = 1,\n  translate = { x: 0, y: 0 }\n) => {\n  keypoints.forEach(keypoint => {\n    if (keypoint.score >= minConfidence) {\n      const { y, x } = keypoint.position;\n      const t_x = x + translate.x;\n      const t_y = y + translate.y;\n      ctx.beginPath();\n      ctx.arc(t_x * scale, t_y * scale, 3, 0, 2 * Math.PI);\n      ctx.fillStyle = skeletonColor;\n      ctx.fill();\n    }\n  });\n};\n\nconst toTuple = ({ y, x }) => [y, x];\n\nconst toTranslatedTuple = ({ y, x }, translate) => [\n  y + translate.y,\n  x + translate.x\n];\n\nconst drawSegment = ([ay, ax], [by, bx], color, lineWidth, scale, ctx) => {\n  ctx.beginPath();\n  ctx.moveTo(ax * scale, ay * scale);\n  ctx.lineTo(bx * scale, by * scale);\n  ctx.lineWidth = lineWidth;\n  ctx.strokeStyle = color;\n  ctx.stroke();\n};\n\nexport const drawSkeleton = (\n  keypoints,\n  minConfidence,\n  color,\n  lineWidth,\n  ctx,\n  scale = 1,\n  translate = { x: 0, y: 0 }\n) => {\n  const adjacentKeyPoints = posenet.getAdjacentKeyPoints(\n    keypoints,\n    minConfidence\n  );\n\n  adjacentKeyPoints.forEach(keypoints => {\n    drawSegment(\n      toTranslatedTuple(keypoints[0].position, translate),\n      toTranslatedTuple(keypoints[1].position, translate),\n      color,\n      lineWidth,\n      scale,\n      ctx\n    );\n  });\n};\n\n// draw3dModel\n// exact same thing\n","export const magnitude = vec => {\n  const squaredTotal = vec.map(num => Math.pow(num, 2)).reduce((a, b) => a + b); // sum of squares\n  const mag = Math.sqrt(squaredTotal); // squared root\n  return mag;\n};\n\nexport const dotProduct = (vec1, vec2) => {\n  if (vec1.length !== vec2.length) {\n    throw new Error(\n      \"vector lengths are not similar. please make sure vector 1 and vector 2 have the same length.\"\n    );\n  }\n  const sumOfMultiplications = vec1\n    .map((vec, i) => vec * vec2[i]) // multiply each scalar in the vector\n    .reduce((a, b) => a + b); // sum\n  return sumOfMultiplications;\n};\n\nexport const cosineSimilarity = (vector1, vector2) => {\n  const sim =\n    dotProduct(vector1, vector2) / (magnitude(vector1) * magnitude(vector2));\n  return sim;\n};\n","import { extent } from \"d3-array\";\nimport { cosineSimilarity } from \"./cosineSimilarity\";\n\nconst SCORE_MIN = 0.9;\n\nfunction remap(value, low1, high1, low2, high2) {\n  return low2 + ((high2 - low2) * (value - low1)) / (high1 - low1);\n}\n\n// find bounding box of pose\nconst calculatePoseDomain = pose => {\n  const keypoints = pose.keypoints;\n  const x = keypoints.map(v => v.position.x);\n  const y = keypoints.map(v => v.position.y);\n\n  const xDomain = extent(x);\n  const yDomain = extent(y);\n\n  return { x: xDomain, y: yDomain };\n};\n\n// return an array of poses with current pose in the middle of array\n// frameNumber == which point in time (of the poseSet) do you want to compare?\nconst findClosestPoses = (\n  frameNumber,\n  poseSet,\n  count = 5,\n  includeDist = false\n) => {\n  const index = frameNumber;\n  // find n closest poses compared to input pose and its index\n  const split = Math.round(count / 2);\n  // the first item in leftHalf is the current index\n  const leftHalf = Array(split)\n    .fill(split)\n    .map((v, i) => Math.max(index - i, 0));\n\n  const rightHalf = Array(count - split)\n    .fill(count - split)\n    .map((v, i) => index + 1 + i);\n\n  const closestNIndices = [...leftHalf, ...rightHalf].sort((a, b) => a - b);\n\n  if (includeDist) {\n    return closestNIndices.map((v, i) => {\n      return {\n        distance: Math.abs(index - v),\n        index: v,\n        pose: poseSet[v]\n      };\n    });\n  } else {\n    return closestNIndices.map(v => poseSet[v]);\n  }\n};\n\n// convert pose into vector,\n// option to resize to 0-1 for scoring\n// option to ensure vector is length 34 (for tfjs posenet)\nconst vectorizePose = (pose, resize = true, cleanup = true) => {\n  let arrayOut;\n\n  if (!pose || pose.length === 0) return [];\n\n  // maintain pose order\n  const keypoints = pose.keypoints;\n  // const keypoints = pose.keypoints.sort((a, b) => {\n  //   const x = a.part;\n  //   const y = b.part;\n\n  //   if (x < y) return -1;\n  //   if (x > y) return 1;\n  //   return 0;\n  // });\n\n  // resize == remap x and y to 0 to 1\n  if (resize) {\n    const { x, y } = calculatePoseDomain(pose);\n    const xMin = x[0];\n    const xMax = x[1];\n    const yMin = y[0];\n    const yMax = y[1];\n\n    //todo test this\n    arrayOut = [].concat.apply(\n      [],\n      keypoints.map(v => [\n        remap(v.position.y, yMin, yMax, 0, 1),\n        remap(v.position.x, xMin, xMax, 0, 1)\n      ])\n    );\n  } else {\n    arrayOut = [].concat.apply(\n      [],\n      keypoints.map(v => [v.position.y, v.position.x])\n    );\n  }\n\n  // ensure length === 34\n  if (cleanup) {\n    const len = arrayOut.length;\n    if (len !== 34) {\n      if (len < 34) {\n        console.log(`current keypoint count is ${len}. should be 34.`);\n      }\n      arrayOut = arrayOut.slice(0, 34);\n    }\n  }\n\n  return arrayOut;\n};\n\nconst scoreSimilarity = (\n  currentPose,\n  currentTimeFrame,\n  comparisonPoseSet,\n  compareNearestFrames = 5,\n  includeDistance = true,\n  accuracyInDecimals = 4\n) => {\n  const PENALTY = 0.001;\n  const c_Pose = vectorizePose(currentPose, true, true);\n\n  // score nearest n poses with current pose\n  const scoreFrames = findClosestPoses(\n    currentTimeFrame,\n    comparisonPoseSet,\n    compareNearestFrames,\n    includeDistance\n  ).map((v, i) => {\n    if (!v.pose) {\n      return {\n        distance: 1,\n        score: 0,\n        cosineSimilarity: 0,\n        weightedSimilarity: 0,\n        index: v.index\n      };\n    }\n\n    const vs_pose = v.pose.pose[0];\n\n    const comparisonPose = vectorizePose(vs_pose, true, true);\n    const comparisonPoseConfidence = vs_pose.score;\n    const comparisonPoseDistance = v.distance;\n    const comparisonPoseIndex = v.index;\n\n    // cosine similarity\n    const similarity = cosineSimilarity(c_Pose, comparisonPose).toFixed(\n      accuracyInDecimals\n    );\n    // penalize by accuracy/confidence\n    const weightedSimilarity = comparisonPoseConfidence * similarity;\n    // also penalize by how many frame did you lag behind\n    const finalSimilarity =\n      weightedSimilarity - comparisonPoseDistance * PENALTY;\n\n    return {\n      distance: comparisonPoseDistance,\n      score: finalSimilarity,\n      cosineSimilarity: similarity,\n      weightedSimilarity: weightedSimilarity,\n      index: comparisonPoseIndex\n    };\n  });\n\n  const highestScore = scoreFrames\n    .map(v => v.score)\n    .sort((a, b) => a - b)\n    .reverse()[0];\n  const currentFrameScore = scoreFrames.filter(v => v.distance === 0)[0].score;\n\n  return {\n    score: {\n      normalized: Math.max(remap(highestScore, SCORE_MIN, 1.0, 0, 100), 0),\n      highest: highestScore,\n      current: currentFrameScore,\n      all: scoreFrames\n    }\n  };\n};\n\nexport default scoreSimilarity;\n","const generateScoreTimer = props => {\n  const def = {\n    totalSecs: (props && props.totalSecs) || 10,\n    beatsPerLoop: (props && props.beatsPerLoop) || 4,\n    loopSec: (props && props.loopSec) || 2.6,\n    pattern: (props && props.pattern) || [1, 3]\n  };\n\n  console.log(def);\n\n  const beatUnit = def.loopSec / def.beatsPerLoop;\n  const total = def.totalSecs;\n  let peaks = [...def.pattern];\n  let scoreTimeStamp = [];\n\n  let beat = 0;\n  for (let secs = 0; secs < total; secs = secs + beatUnit) {\n    // if count is more than beats, reset to 0\n    if (beat === def.beatsPerLoop) beat = 0;\n    // if pattern ends, repeat pattern\n    if (peaks.length === 0) {\n      peaks = [...def.pattern];\n    }\n\n    // for every beat, evaluate whether is is pattern\n    const chk = peaks[0];\n    if (chk === beat) {\n      scoreTimeStamp.push(secs);\n\n      peaks.shift(); // take out used item\n    }\n\n    // if it matches first item in PATTERN, array.shift() it out of the template\n    // https://sdras.github.io/array-explorer/\n    // and send a callback to score the user\n    // TODO: this is also where you place the images to perform pose comparison\n    // console.log(\"beat: \", beat);\n    // console.log(\"time: \", secs);\n    // console.log(\"\");\n    beat++;\n  }\n\n  console.log(\"SCORING HEURISTIC\");\n  console.log(scoreTimeStamp);\n  return scoreTimeStamp;\n};\n\ngenerateScoreTimer.defaultProps = {\n  totalSecs: 10,\n  beatsPerLoop: 4,\n  loopSec: 2.6,\n  pattern: [1, 3]\n};\n\nexport default generateScoreTimer;\n","// ref: https://github.com/jscriptcoder/tfjs-posenet/blob/master/src/PoseNet/index.jsx\n\n// TODO: only show peak pose frame, other poses are semi transparent\n\n// main imports\nimport React, { Component } from \"react\";\nimport * as posenet from \"@tensorflow-models/posenet\";\n\nimport Webcam from \"react-webcam\";\n\n// styles\nimport styles from \"./index.module.css\";\n\n// components\nimport { isMobile, drawKeypoints, drawSkeleton } from \"./helpers/utils\";\nimport scoreSimilarity from \"./helpers/scorer\";\nimport generateScoreTimer from \"./helpers/calculatePeakBeats\";\n\n// ghost (the dance move you're competing with)\nimport { DANCE_GHOST } from \"../../lib/constants\";\nconst GHOST = DANCE_GHOST.poseRecords;\n\n// WHEN to score user\nconst t = GHOST[GHOST.length - 1].timestamp;\nconst SCORING_HEURISTIC = generateScoreTimer({\n  totalSecs: t,\n  pattern: [1, 3]\n});\n\nexport default class PoseNetComponent extends Component {\n  static defaultProps = {\n    videoWidth: window.innerWidth,\n    videoHeight: window.innerHeight,\n    algorithm: \"single-pose\",\n    mobileNetArchitecture: isMobile() ? 0.5 : 1.01,\n    showVideo: true,\n    showSkeleton: true,\n    showPoints: true,\n    minPoseConfidence: 0.1,\n    minPartConfidence: 0.1,\n    maxPoseDetections: 2,\n    nmsRadius: 20.0,\n    outputStride: 16,\n    imageScaleFactor: 0.3,\n    skeletonColor: \"aqua\",\n    ghostColor: \"yellow\",\n    skeletonLineWidth: 8,\n    loadingText: \"Loading pose detector...\",\n    frontCamera: true,\n    stop: false,\n    record: false,\n    recordVideo: false,\n    maxFPS: 30,\n    compete: true,\n    scoreByHeuristic: true\n  };\n\n  state = {\n    loading: true,\n    error_messages: \"\",\n    stream: null,\n    trace: [],\n    frames: [],\n    ghostIndex: 0,\n    repeat: false,\n    score: 0,\n    totalScore: 0,\n    scoreOpacity: 0,\n    time: 0,\n    stop: false,\n    finalDims: { height: 0, width: 0 }\n  };\n  camera = undefined;\n  timeout = undefined;\n  good_keypoints = {};\n  previousDelta = 0;\n  lastScore = 0;\n\n  errorMessages = () => {\n    // pipe out error messages\n    if (this.props.errorMessages) {\n      this.props.errorMessages(this.state.error_messages);\n    }\n  };\n\n  // the traced sequence\n  getPoseRecords() {\n    if (this.props.getPoseRecords) {\n      this.props.getPoseRecords(this.state.trace);\n    }\n  }\n\n  getVideoRecords = () => {\n    if (this.props.getVideoRecords) {\n      this.props.getVideoRecords(this.state.frames);\n    }\n  };\n\n  tracePose = poses => {\n    if (this.props.record) {\n      this.setState({ trace: [...this.state.trace, poses] });\n    }\n  };\n\n  traceVideo = blob => {\n    if (this.props.record) {\n      this.setState({ frames: [...this.state.frames, blob] });\n    }\n  };\n\n  getCanvas = elem => {\n    this.canvas = elem;\n  };\n\n  getVideo = elem => {\n    try {\n      this.video = elem.video; // react-webcam\n    } catch (e) {\n      this.video = elem; // html5 video tag\n    }\n  };\n\n  stopCamera = () => {\n    const cam = this.camera;\n    if (cam) {\n      const stream = cam.srcObject;\n      const tracks = stream.getTracks();\n\n      // stop all tracks\n      tracks.map(t => t.stop());\n      this.camera = undefined;\n      this.setState({ loading: true, stop: true });\n    }\n  };\n\n  startCamera = () => {\n    const cam = this.camera;\n    if (cam) {\n      this.setState({ loading: false, stop: false });\n    } else {\n      this.stopCamera();\n    }\n  };\n\n  setupCamera = async () => {\n    // MDN: https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices\n    if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\n      const e1 =\n        \"Browser API navigator.mediaDevices.getUserMedia not available\";\n      this.setState({ error_messages: e1 });\n      throw e1;\n    }\n\n    const { videoWidth, videoHeight } = this.props;\n    const video = this.video;\n    const mobile = isMobile();\n    const frontCamera = this.props.frontCamera;\n\n    video.width = videoWidth;\n    video.height = videoHeight;\n    video.style.objectFit = \"contain\";\n\n    // MDN: https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia\n    // const stream = await navigator.mediaDevices.getUserMedia({\n    //   audio: false,\n    //   video: {\n    //     facingMode: frontCamera ? \"user\" : { exact: \"environment\" },\n    //     // width: videoWidth,\n    //     // height: videoHeight\n    //     width: mobile ? void 0 : videoWidth,\n    //     height: mobile ? void 0 : videoHeight\n    //   }\n    // });\n\n    // video.srcObject = stream;\n\n    return new Promise(resolve => {\n      video.onloadedmetadata = () => {\n        // Once the video metadata is ready, we can start streaming video\n        video.play();\n\n        const finalDims = {\n          height: video.videoHeight, // actual video running\n          width: video.videoWidth\n        };\n\n        video.width = video.videoWidth;\n        video.height = video.videoHeight;\n\n        this.setState({ finalDims });\n        resolve(video); // promise returns video\n      };\n    });\n  };\n\n  detectPose = () => {\n    //const { videoWidth, videoHeight } = this.props;\n    const videoWidth = this.state.finalDims.width;\n    const videoHeight = this.state.finalDims.height;\n\n    const canvas = this.canvas;\n    const ctx = canvas.getContext(\"2d\");\n\n    canvas.width = videoWidth;\n    canvas.height = videoHeight;\n\n    this.poseDetectionFrame(ctx);\n  };\n\n  poseDetectionFrame = ctx => {\n    const {\n      algorithm,\n      imageScaleFactor,\n      forceFlipHorizontal,\n      outputStride,\n      minPoseConfidence,\n      maxPoseDetections,\n      minPartConfidence,\n      nmsRadius,\n      //videoWidth,\n      //videoHeight,\n      showVideo,\n      showPoints,\n      showSkeleton,\n      skeletonColor,\n      ghostColor,\n      translateGhost,\n      skeletonLineWidth,\n      frontCamera,\n      stop,\n      maxFPS,\n      compete,\n      scoreByHeuristic\n    } = this.props;\n\n    const { finalDims } = this.state;\n\n    const videoHeight = finalDims.height;\n    const videoWidth = finalDims.width;\n\n    const net = this.net;\n    const video = this.video;\n    let heuristic = [...SCORING_HEURISTIC];\n\n    const flipped = forceFlipHorizontal\n      ? forceFlipHorizontal\n      : frontCamera\n      ? true\n      : false;\n\n    const poseDetectionFrameInner = async currentDelta => {\n      // stops running if complete\n      if (this.props.stop || this.state.stop || !this.camera) {\n        return;\n      }\n      // this is to cap fps\n      //requestAnimationFrame(poseDetectionFrameInner);\n      requestAnimationFrame(poseDetectionFrameInner);\n      const delta = parseInt(currentDelta - this.previousDelta);\n      const maxDelta = parseInt(1000 / maxFPS);\n\n      // another way to count fps\n      // see how many repeats of each second shows up on the console\n      //console.log(parseInt(performance.now() / 1000));\n\n      // ^ above == \"how long did it take to get here since the last frame in ms?\"\n      if (maxFPS && delta < maxDelta) {\n        // 1000 / fps == frames per millisecond\n        console.log(\"capped!\", delta);\n\n        return;\n      }\n\n      // pose calculation starts here\n      let poses = [];\n\n      switch (algorithm) {\n        case \"single-pose\":\n          const pose = await net.estimateSinglePose(\n            video,\n            imageScaleFactor,\n            flipped,\n            outputStride\n          );\n\n          poses.push(pose);\n          break;\n\n        case \"multi-pose\":\n          poses = await net.estimateMultiplePoses(\n            video,\n            imageScaleFactor,\n            flipped,\n            outputStride,\n            maxPoseDetections,\n            minPartConfidence,\n            nmsRadius\n          );\n\n          break;\n      }\n\n      // CLEAR SCREEN\n      // ------------\n      ctx.clearRect(0, 0, videoWidth, videoHeight);\n\n      // SHOW VIDEO FRAME\n      // ----------------\n      if (showVideo) {\n        ctx.save();\n        if (flipped) {\n          // https://christianheilmann.com/2013/07/19/flipping-the-image-when-accessing-the-laptop-camera-with-getusermedia/\n          ctx.scale(-1, 1);\n          ctx.translate(-videoWidth, 0);\n        }\n        ctx.drawImage(video, 0, 0, videoWidth, videoHeight);\n        ctx.restore();\n      }\n\n      // DRAW CURRENT PREDICTION\n      // -----------------------\n      // For each pose (i.e. person) detected in an image, loop through the poses\n      // and draw the resulting skeleton and keypoints if over certain confidence\n      // scores\n      poses.forEach(({ score, keypoints }) => {\n        if (score >= minPoseConfidence) {\n          if (showPoints) {\n            drawKeypoints(keypoints, minPartConfidence, skeletonColor, ctx);\n          }\n          if (showSkeleton) {\n            drawSkeleton(\n              keypoints,\n              minPartConfidence,\n              skeletonColor,\n              skeletonLineWidth,\n              ctx\n            );\n          }\n        }\n      });\n\n      // DRAW GHOST DANCER\n      // -----------------\n      if (compete) {\n        // if compete is triggered, start timer\n        // trigger is the same as record\n        if (this.state.time === 0) {\n          this.setState({ time: performance.now() });\n        }\n\n        if (!GHOST[this.state.ghostIndex]) {\n          // end of loop\n          console.log(\"RESET!!!!\");\n          const millis = performance.now() - this.state.time;\n          console.log(\"seconds elapsed = \" + Math.floor(millis / 1000));\n\n          // for now, repeat loop\n          if (this.state.repeat) {\n            // ENDLESS MODE FTW\n            this.setState({ ghostIndex: 0 });\n          } else {\n            this.stopCamera();\n            if (this.props.onEnd) {\n              this.props.onEnd(this.state.totalScore);\n            }\n            this.setState({\n              totalScore: 0,\n              time: performance.now(),\n              stop: true\n            });\n          }\n        } else {\n          const ind = this.state.ghostIndex;\n          const g_keypoints = GHOST[ind].pose[0].keypoints;\n          const g_score = GHOST[ind].pose[0].score;\n\n          const g_timestamp = GHOST[ind].timestamp;\n          const timestamp_now = (performance.now() - this.state.time) / 1000;\n\n          console.log(`REC: ${g_timestamp} NOW: ${timestamp_now}`);\n\n          if (g_score >= minPoseConfidence) {\n            // only update keypoints when it passes the confidence threshold\n            this.good_keypoints = g_keypoints;\n          }\n          // else use the previous one\n          if (showPoints) {\n            drawKeypoints(\n              this.good_keypoints,\n              minPartConfidence,\n              ghostColor,\n              ctx\n            );\n          }\n          if (showSkeleton) {\n            drawSkeleton(\n              this.good_keypoints,\n              minPartConfidence,\n              ghostColor,\n              skeletonLineWidth,\n              ctx\n            );\n          }\n\n          // SCORE USER AGAINST GHOST\n          const userPose = poses[0];\n          const similarity = scoreSimilarity(\n            userPose,\n            this.state.ghostIndex, // TODO: change this to g_timestamp\n            GHOST\n          );\n\n          //console.log(\"score: \", similarity.score.highest);\n\n          const score = parseInt(similarity.score.normalized.toFixed(2));\n\n          if (!scoreByHeuristic) {\n            //console.log(\"scoring on every frame!\");\n            this.setState(prev => ({\n              score: score,\n              totalScore: prev.totalScore + score\n            }));\n          } else {\n            // only add score if timestmap matches\n            let GHOST_timestamp = heuristic; // ref only, so shift will affect heuristic\n            const NOW_timestamp = (\n              (performance.now() - this.state.time) /\n              1000\n            ).toFixed(5);\n\n            // if current frame timestamp is equal or more than the next beat\n            if (GHOST_timestamp[0] <= NOW_timestamp && heuristic.length !== 0) {\n              console.log(\"score: \", score);\n              console.log(\"heuristic: \", heuristic);\n              this.setState(prev => ({\n                score: score,\n                totalScore: prev.totalScore + score\n              }));\n              heuristic.shift();\n            }\n          }\n        }\n      }\n\n      // SHOW OUTPUT\n      // -----------\n      if (stop || this.state.stop || !this.camera) {\n        console.log(\"complete!\");\n        // clear canvas\n        ctx.clearRect(0, 0, videoWidth, videoHeight);\n      } else {\n        const singlePose = poses.slice(0, 1);\n        // to prevent multipose from screwing data\n        // it only keeps the highest\n        // TODO: allow multi pose recordings\n\n        if (this.props.record) {\n          // if record is triggered, start timer\n          if (this.state.time === 0) {\n            this.setState({ time: performance.now() });\n          }\n\n          if (this.props.recordVideo) {\n            //console.log(\"recording frame and video!\");\n          } else {\n            //console.log(\"recording frames!\");\n          }\n          // trace with timestamp\n          // https://stackoverflow.com/questions/8279729/calculate-fps-in-canvas-using-requestanimationframe\n          this.tracePose({\n            pose: singlePose,\n            timestamp: (performance.now() - this.state.time) / 1000\n          });\n          // record video\n          this.canvas.toBlob(this.traceVideo, \"image/jpeg\", 0.4);\n\n          // stream poses to parent\n          this.getPoseRecords();\n          this.getVideoRecords();\n        } else if (!this.props.record && this.state.time !== 0) {\n          this.setState({ time: 0 });\n        }\n\n        // call next recursion\n        // ONLY IF THE TIMESTAMP OF RECORD IS SLOWER THAN CURRENT TIMESTAMP\n        const REC = GHOST[this.state.ghostIndex].timestamp.toFixed(5);\n        const NOW = ((performance.now() - this.state.time) / 1000).toFixed(5);\n\n        if (REC < NOW) {\n          this.setState(prevState => ({\n            ...prevState,\n            ghostIndex: prevState.ghostIndex + 1\n          }));\n        }\n\n        this.previousDelta = currentDelta;\n      }\n    };\n\n    poseDetectionFrameInner();\n  };\n\n  async componentDidMount() {\n    this.net = await posenet.load(this.props.mobileNetArchitecture);\n    //console.log(\"loaded mobilenet\");\n    //console.log(this.net);\n\n    try {\n      this.camera = await this.setupCamera();\n    } catch (e) {\n      const e2 =\n        \"This browser does not support video capture, or this device does not have a camera\";\n      this.setState({ error_messages: e2 });\n      throw e2;\n    } finally {\n      this.setState({ loading: false });\n    }\n\n    this.detectPose();\n  }\n\n  async componentDidUpdate(prevProps, prevState) {\n    if (prevProps !== this.props) {\n      if (prevProps.frontCamera !== this.props.frontCamera) {\n        // stop existing camera\n        this.stopCamera();\n        // setup and start\n        this.camera = await this.setupCamera();\n        this.startCamera();\n        // detect pose\n        this.detectPose();\n      }\n    }\n\n    if (prevState !== this.state) {\n      if (prevState.score !== this.state.score && this.state.score !== 0) {\n        if (this.timeout) clearTimeout(this.timeout);\n        this.setState({ scoreOpacity: 1 });\n        this.timeout = setTimeout(\n          () => this.setState({ scoreOpacity: 0 }),\n          3000\n        );\n      }\n    }\n  }\n\n  componentWillUnmount() {\n    console.log(\"component will unmounts!\");\n    this.stopCamera();\n    this.setState({ stop: true });\n  }\n\n  render() {\n    const loading = this.state.loading ? (\n      <div className={styles.loading}>\n        <code>{this.props.loadingText}</code>\n        <br />\n        <code style={{ color: \"red\", fontSize: 12 }}>\n          {this.state.error_messages}\n        </code>\n      </div>\n    ) : (\n      \"\"\n    );\n\n    this.errorMessages();\n\n    const Score = () => {\n      if (this.state.score !== 0) this.lastScore = this.state.score;\n\n      return (\n        <div className={styles.scores}>\n          <p className={styles.totalScore}>{this.state.totalScore}</p>\n          <p\n            className={styles.score}\n            style={{\n              opacity: this.state.scoreOpacity\n            }}\n          >\n            {this.lastScore}\n          </p>\n        </div>\n      );\n    };\n\n    return (\n      <div className={styles.posenet}>\n        {this.props.compete && <Score />}\n        {loading}\n\n        <div\n          className={styles.posenetCanvasContainer}\n          style={{ width: this.props.videoWidth, overflow: \"hidden\" }}\n        >\n          <Webcam ref={this.getVideo} playsInline />\n          <canvas className={styles.posenetCanvas} ref={this.getCanvas} />\n        </div>\n      </div>\n    );\n  }\n}\n","// posenet code, takes in video feed and returns pose\n// also records video feed\nimport Posenet from \"./Posenet\";\n\nexport default Posenet;\n","import React, { useEffect, useState } from \"react\";\nimport styles from \"./index.module.css\";\n\nimport Posenet from \"../../components/Posenet\";\n\nconst MAX_WIDTH = 375;\n\nconst Page = ({ onScore, onRestart }) => {\n  const [restarting, setRestarting] = useState(false);\n  const [score, setScore] = useState(0);\n  const [phase, setPhase] = useState(\"\");\n  const [dims, setDims] = useState({ height: 0, width: 0 });\n  useEffect(() => {\n    // didmount\n    console.log(\"mounted this page yo\");\n    setDims({\n      height: window.innerHeight,\n      width: Math.min(window.innerWidth, MAX_WIDTH)\n    });\n\n    // show modal, prepare user to start\n    setPhase(\"start\");\n\n    return () => console.log(\"unmounted this page yo\");\n  }, []);\n\n  const handleClick = type => {\n    if (type === \"start\") {\n      setPhase(\"play\");\n      setRestarting(false);\n    } else if (type === \"end\") {\n      setPhase(\"submit\");\n      setRestarting(true);\n      if (onScore) {\n        onScore(score);\n      }\n    } else if (type === \"retry\") {\n      setRestarting(true);\n      if (onRestart) {\n        onRestart();\n      }\n    }\n  };\n\n  // handles live recording of pose\n  const onTracePose = p => {};\n\n  const onTraceVideo = v => {\n    //console.log(v)\n  };\n\n  // when one loop ends, trigger this\n  const handleRecordEnd = score => {\n    console.log(\"SCORE IS\");\n    console.log(score);\n    setScore(score);\n    setPhase(\"end\");\n  };\n\n  const Modal = ({ type, onClick, score }) => {\n    if (type === \"start\") {\n      return (\n        <div className={styles.modalStart}>\n          <p>Ready to go?</p>\n          <button onClick={() => onClick(type)}>START!</button>\n        </div>\n      );\n    } else if (type === \"end\") {\n      return (\n        <div className={styles.modalEnd}>\n          <p>your score is {score}</p>\n          <p>do you want to submit?</p>\n          <button onClick={() => onClick(\"retry\")}>RETRY</button>\n          <button onClick={() => onClick(type)}>SUBMIT</button>\n        </div>\n      );\n    } else if (type === \"play\") {\n      return (\n        <Posenet\n          restart={restarting}\n          onEnd={handleRecordEnd}\n          videoWidth={dims.width}\n          videoHeight={dims.height}\n          mobileNetArchitecture={0.5}\n          outputStride={8}\n          loadingText={\"Loading...\"}\n          frontCamera={true}\n          getPoseRecords={onTracePose}\n          getVideoRecords={onTraceVideo}\n          showVideo={true}\n          algorithm={\"single-pose\"}\n          record={true}\n          recordVideo\n        />\n      );\n    } else {\n      return null;\n    }\n  };\n\n  return (\n    <div className={styles.page}>\n      <Modal type={phase} onClick={handleClick} score={score} />\n    </div>\n  );\n};\n\nexport default Page;\n","import firebase from \"firebase\";\n\nconst config = {\n  apiKey: process.env.apiKey,\n  authDomain: process.env.authDomain,\n  databaseURL: process.env.databaseURL,\n  projectId: process.env.projectId,\n  storageBucket: process.env.storageBucket,\n  messagingSenderId: process.env.messagingSenderId\n};\n\nconst reactConfig = {};\nObject.keys(config).map(v => {\n  reactConfig[v] = process.env[`REACT_APP_${v}`];\n});\n\nif (!firebase.apps.length) {\n  firebase.initializeApp(reactConfig);\n}\n\nexport default firebase;\n//module.exports = firebase;\n\nexport const ReadFromFirebase = (databaseRef = \"danceoff\", callback) => {\n  return firebase\n    .database()\n    .ref(databaseRef)\n    .on(\"value\", snapshot => {\n      const vals = snapshot.val();\n      callback(vals);\n    });\n};\n\nexport const ReadSortedFromFirebase = (\n  databaseRef = \"danceoff\",\n  sortKey = \"score\",\n  limit = 50,\n  callback\n) => {\n  return firebase\n    .database()\n    .ref(databaseRef)\n    .orderByChild(sortKey)\n    .limitToLast(limit)\n    .on(\"value\", snapshot => {\n      const sortedVals = [];\n      snapshot.forEach(child => {\n        sortedVals.push(child.val());\n      });\n\n      callback(sortedVals.reverse());\n    });\n};\n\nexport const PushToFirebase = (databaseRef = \"danceoff\", data, callback) => {\n  firebase\n    .database()\n    .ref(databaseRef)\n    .push(data)\n    .then(v => callback(v));\n};\n","import React, { useEffect, useState } from \"react\";\n\nimport styles from \"./index.module.css\";\n\nimport { ReadSortedFromFirebase } from \"../../lib/firebase\";\nimport { DB_PATH } from \"../../lib/constants\";\n\nconst Rankings = () => {\n  const [rankings, setRankings] = useState([]);\n\n  useEffect(() => {\n    // mount db listener\n    ReadSortedFromFirebase(DB_PATH, \"score\", 30, setRankings);\n  }, []);\n\n  const ListRankings = () => {\n    const keys = Object.keys(rankings);\n    console.log(\"List nrakings\");\n    console.log(keys);\n\n    if (keys.length === 0) return <p>no data.</p>;\n\n    return (\n      <ol className={styles.rankingOL}>\n        {keys.map((k, i) => (\n          <li className={styles.rankingLI} key={i}>\n            <p>{rankings[k].user}</p>\n            <p>{rankings[k].score}</p>\n          </li>\n        ))}\n      </ol>\n    );\n  };\n\n  return (\n    <>\n      <h1 className={styles.title}>Leaderboard</h1>\n      <div className={styles.rankings}>\n        <ListRankings />\n      </div>\n    </>\n  );\n};\n\nexport default Rankings;\n","import React, { useState, useEffect } from \"react\";\n\nimport styles from \"./index.module.css\";\n\nimport Button from \"../Button\";\n\nimport { PushToFirebase } from \"../../lib/firebase\";\nimport { DB_PATH } from \"../../lib/constants\";\n\nconst Submit = ({ score }) => {\n  const [username, setUsername] = useState();\n  const handleChange = e => {\n    setUsername(e.target.value);\n  };\n\n  const [userScore, setUserScore] = useState();\n  useEffect(() => {\n    // fix initial user score on mount\n    setUserScore(score);\n  }, []);\n\n  const [posted, setPosted] = useState(false);\n  useEffect(() => {\n    // check if score changed before allowing repost\n    if (score !== userScore) {\n      setPosted(false);\n      setUserScore(score);\n    }\n  }, [score]);\n\n  const handleSubmit = e => {\n    const data = {\n      user: username || \"anonymous\",\n      score: score || 0\n    };\n    // send to firebase\n    PushToFirebase(DB_PATH, data, v => console.log(v));\n    setPosted(true);\n    e.preventDefault();\n  };\n\n  const form = (\n    <div className={styles.formDiv}>\n      <form className={styles.form} onSubmit={handleSubmit}>\n        <h3>Your score is: {score}</h3>\n        <p className={styles.cta}>Enter Your Name</p>\n        <input\n          className={styles.input}\n          type=\"text\"\n          onChange={handleChange}\n          value={username}\n          placeholder=\"JACK\"\n        />\n        <br />\n        <Button theme=\"default\" type=\"Submit\">\n          Submit\n        </Button>\n      </form>\n    </div>\n  );\n\n  const thanks = (\n    <div className={styles.thankYou}>\n      <h3>Thanks for Playing!</h3>\n      <p>if you want to play again, go back to RECORD and start moving!</p>\n    </div>\n  );\n\n  return posted ? thanks : form;\n};\n\nexport default Submit;\n","import React, { useEffect } from \"react\";\nimport styles from \"./index.module.css\";\n\nimport Rankings from \"../../components/Rankings\";\nimport PostRanking from \"../../components/PostRanking\";\n\nconst Page = ({ score }) => {\n  useEffect(() => {\n    // didmount\n    console.log(\"mounted this page yo\");\n\n    return () => console.log(\"unmounted this page yo\");\n  }, []);\n  return (\n    <div className={styles.page}>\n      <Rankings />\n      <PostRanking score={score} />\n    </div>\n  );\n};\n\nexport default Page;\n","import React, { useState } from \"react\";\nimport logo from \"./logo.svg\";\nimport \"./App.css\";\n\nimport styles from \"./App.module.css\";\n\n// Navigation\nimport Navigation from \"./components/Navigation\";\n\n// intro\nimport Intro from \"./pages/Intro\";\n// watch\nimport Learn from \"./pages/Learn\";\n// record\nimport Record from \"./pages/Record\";\n// leaderboard\nimport Leaderboard from \"./pages/Leaderboard\";\n\nconst App = () => {\n  const [page, setPage] = useState(\"record\");\n  const [score, setScore] = useState(0);\n\n  const handleScore = score => {\n    setScore(score);\n    setPage(\"compete\");\n  };\n\n  const handleRestart = () => {\n    setPage(\"watch\"); // TODO: a separate ready page\n    setTimeout(() => setPage(\"record\"), 300);\n  };\n\n  const NavRoute = ({ page }) => {\n    switch (page) {\n      case \"home\":\n        return <Intro onClick={() => setPage(\"watch\")} />;\n      case \"watch\":\n        return <Learn />;\n      case \"record\":\n        return <Record onScore={handleScore} onRestart={handleRestart} />;\n      case \"compete\":\n        return <Leaderboard score={score} />;\n      default:\n        return <Intro />;\n    }\n  };\n  return (\n    <div className={styles.app}>\n      <NavRoute page={page} />\n      {page !== \"home\" ? <Navigation onClick={setPage} /> : \"\"}\n    </div>\n  );\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nrequire(\"dotenv\").config();\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"form\":\"PostRanking_form__2as46\",\"input\":\"PostRanking_input__1AoXs\",\"formDiv\":\"PostRanking_formDiv__291kB\",\"thankYou\":\"PostRanking_thankYou__3nLOl\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"title\":\"Rankings_title__1NMH7\",\"rankings\":\"Rankings_rankings__3XuR5\",\"rankingOL\":\"Rankings_rankingOL__2heD6\",\"rankingLI\":\"Rankings_rankingLI__2qCp_\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"page\":\"Record_page__2IDLo Layout_page__3AEwV\",\"modal\":\"Record_modal__MMDii\",\"modalStart\":\"Record_modalStart__3667M Record_modal__MMDii\",\"modalEnd\":\"Record_modalEnd__3PbMl Record_modal__MMDii\"};"],"sourceRoot":""}